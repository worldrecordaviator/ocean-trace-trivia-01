<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ocean Trace New Year Trivia</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --team-1: #ff4757; --team-2: #3742fa; --team-3: #2ed573; --team-4: #ffa502; --bg: #020617; --text: #f8fafc; --accent: #f59e0b; --correct: #10b981; }
        body { font-family: 'Arial Black', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; text-align: center; overflow: hidden; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        
        #game-progress-header { position: fixed; top: 0; left: 0; width: 100%; height: 50px; background: #1e293b; z-index: 1000; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; font-weight: bold; letter-spacing: 3px; border-bottom: 3px solid #334155; }
        #progress-fill { position: absolute; top: 0; left: 0; height: 100%; width: 0%; background: rgba(245, 158, 11, 0.4); transition: width 0.5s ease; z-index: -1; border-right: 5px solid var(--accent); }

        #game-container { width: 95%; max-width: 1500px; padding: 20px; margin-top: 60px; }
        
        .scoreboard { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 10px; }
        .team-card { padding: 15px 25px; border-radius: 20px; font-size: 2rem; min-width: 200px; border: 8px solid transparent; background: rgba(255,255,255,0.05); transition: 0.4s; font-weight: bold; }
        
        .active-0 { border-color: var(--team-1); box-shadow: 0 0 40px var(--team-1); transform: scale(1.05); background: rgba(255, 71, 87, 0.1); }
        .active-1 { border-color: var(--team-2); box-shadow: 0 0 40px var(--team-2); transform: scale(1.05); background: rgba(55, 66, 250, 0.1); }
        .active-2 { border-color: var(--team-3); box-shadow: 0 0 40px var(--team-3); transform: scale(1.05); background: rgba(46, 213, 115, 0.1); }
        .active-3 { border-color: var(--team-4); box-shadow: 0 0 40px var(--team-4); transform: scale(1.05); background: rgba(255, 165, 2, 0.1); }

        #diff-header { font-size: 2.2rem; color: var(--accent); text-transform: uppercase; letter-spacing: 8px; margin-top: 10px; }
        #question-display { font-size: 3rem; margin: 20px 0; min-height: 180px; line-height: 1.1; text-shadow: 2px 2px 15px black; display: flex; align-items: center; justify-content: center; }
        
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .btn-opt { background: #1e293b; border: 4px solid #334155; color: white; padding: 25px; font-size: 2rem; border-radius: 20px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-opt:hover { border-color: var(--accent); background: #334155; }

        .timer-container { width: 100%; height: 30px; background: #1e293b; margin-top: 30px; border-radius: 50px; border: 4px solid #334155; overflow: hidden; }
        #timer-bar { width: 100%; height: 100%; background: var(--accent); transition: width 0.1s linear; }

        .full-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; background: rgba(0,0,0,0.98); }
        .correct-overlay { background: rgba(16, 185, 129, 0.95) !important; }
        .msg-text { font-size: 8rem; font-weight: 900; text-transform: uppercase; text-shadow: 0 0 50px black; }
        .points-text { font-size: 4rem; color: white; margin-top: -20px; }
        
        .hidden { display: none !important; }
        .steal-txt { color: var(--accent); font-size: 2.5rem; animation: blinker 1s infinite; font-weight: bold; }
        @keyframes blinker { 50% { opacity: 0; } }

        .footer-controls { position: fixed; bottom: 15px; width: 100%; display: flex; justify-content: center; gap: 15px; }
        .btn-small { padding: 10px 20px; border-radius: 10px; border: none; cursor: pointer; font-weight: bold; font-size: 0.8rem; text-transform: uppercase; background: #334155; color: #94a3b8; }
        .btn-small:hover { background: #475569; color: white; }
        
        .setup-btn { padding: 20px 30px; font-size: 1.5rem; border-radius: 15px; border: 4px solid #334155; background: #1e293b; color: white; cursor: pointer; margin: 8px; font-weight: bold; transition: 0.3s; }
        .setup-btn:hover, .selected-btn { border-color: var(--correct); background: #064e3b; transform: scale(1.05); }
    </style>
</head>
<body>
    <div id="game-progress-header">
        GAME PROGRESS
        <div id="progress-fill"></div>
    </div>

    <div id="game-container">
        <!-- START SCREEN -->
        <div id="start-screen">
            <h1 style="font-size: 5rem; margin: 0;">Ocean Trace</h1>
            <h2 style="color:var(--accent); font-size: 3.5rem; margin: 0;">NEW YEAR TRIVIA</h2>
            
            <div id="resume-container" class="hidden" style="margin: 25px auto; width: fit-content; padding: 15px; border: 3px dashed var(--accent); border-radius: 20px;">
                <button class="setup-btn" onclick="initGame(false)" style="background: var(--accent);">RESUME PROGRESS</button>
            </div>

            <div style="margin-top: 25px;">
                <p style="color: #64748b; font-size: 1.3rem;">1. NUMBER OF TEAMS</p>
                <button class="setup-btn team-btn" onclick="setTeams(2)">2 TEAMS</button>
                <button class="setup-btn team-btn" onclick="setTeams(3)">3 TEAMS</button>
                <button class="setup-btn team-btn" onclick="setTeams(4)">4 TEAMS</button>
            </div>

            <div style="margin-top: 20px;">
                <p style="color: #64748b; font-size: 1.3rem;">2. GAME LENGTH</p>
                <button class="setup-btn len-btn" onclick="setLength(5)">10 MINS (15 Qs)</button>
                <button class="setup-btn len-btn" onclick="setLength(10)">20 MINS (30 Qs)</button>
                <button class="setup-btn len-btn" onclick="setLength(15)">30 MINS (45 Qs)</button>
            </div>

            <button id="start-btn" class="setup-btn hidden" onclick="initGame(true)" style="margin-top: 40px; background: var(--correct); font-size: 2.5rem; padding: 25px 70px;">START GAME</button>
            <div id="bank-status" style="margin-top: 15px; color: #444; font-family: monospace; font-size: 0.9rem;">Bank Loading...</div>
        </div>

        <!-- MAIN GAME -->
        <div id="main-ui" class="hidden">
            <div id="diff-header">MEDIUM</div>
            <div id="scoreboard" class="scoreboard"></div>
            <div id="steal-msg" class="steal-txt hidden">STEAL OPPORTUNITY!</div>
            <div id="question-display"></div>
            <div id="options-grid" class="options-grid"></div>
            <div class="timer-container"><div id="timer-bar"></div></div>
            <div style="margin-top:35px;">
                <button class="btn-opt" style="font-size:1.5rem; padding:15px 40px; background:#475569;" onclick="handlePass()">PASS</button>
                <button id="pause-btn" class="btn-opt" style="font-size:1.5rem; padding:15px 40px; background:var(--accent);" onclick="togglePause()">PAUSE</button>
            </div>
        </div>

        <!-- CORRECT FLASH -->
        <div id="correct-flash" class="full-overlay correct-overlay hidden">
            <div class="msg-text">CORRECT!</div>
            <div id="pts-added" class="points-text"></div>
        </div>

        <!-- REVEAL SCREEN -->
        <div id="reveal-screen" class="full-overlay hidden">
            <h2 style="font-size: 3rem; opacity: 0.6;">THE ANSWER WAS:</h2>
            <div id="reveal-text" style="font-size: 6.5rem; color: var(--correct); font-weight: 900; text-transform: uppercase; padding: 40px;"></div>
        </div>

        <!-- END SCREEN -->
        <div id="end-screen" class="hidden">
            <h1 style="font-size: 4rem; margin-bottom: 0;">GAME OVER</h1>
            <h1 id="winner-text" style="font-size: 7rem; margin-top: 0; color: var(--accent);"></h1>
            <button class="setup-btn" onclick="location.reload()" style="padding: 40px 100px;">BACK TO MENU</button>
        </div>
    </div>

    <!-- FOOTER CONTROLS -->
    <div class="footer-controls">
        <button class="btn-small" onclick="location.reload()">RESTART SESSION (MENU)</button>
        <button class="btn-small" style="background:#ef4444; color:white;" onclick="fullReset()">HARD RESET BANK</button>
    </div>

    <script>
        // MASTER BANK - 120 Questions (MC and TF)
        const masterPool = [
            // MEDIUM (100)
            { id:1, d:"MEDIUM", t:"mc", q: "Which nation inaugurated Nusantara as its new capital in early 2025?", a: ["Indonesia", "Kiribati", "Maldives", "Thailand"], c:0, pts:100 },
            { id:2, d:"MEDIUM", t:"tf", q: "True or False: Kendrick Lamar performed the Super Bowl LIX Halftime show.", a: ["True", "False"], c:0, pts:100 },
            { id:3, d:"MEDIUM", t:"mc", q: "Which tech company reached a $4 Trillion market cap first in early 2025?", a: ["Nvidia", "Apple", "Microsoft", "Google"], c:0, pts:100 },
            { id:4, d:"MEDIUM", t:"tf", q: "True or False: An octopus has three hearts.", a: ["True", "False"], c:0, pts:100 },
            { id:5, d:"MEDIUM", t:"mc", q: "What is the capital city of Australia?", a: ["Canberra", "Sydney", "Melbourne", "Perth"], c:0, pts:100 },
            { id:6, d:"MEDIUM", t:"tf", q: "True or False: Venus is the hottest planet in our solar system.", a: ["True", "False"], c:0, pts:100 },
            { id:7, d:"MEDIUM", t:"mc", q: "Which element has the chemical symbol 'Ag'?", a: ["Silver", "Gold", "Argon", "Iron"], c:0, pts:100 },
            { id:8, d:"MEDIUM", t:"tf", q: "True or False: Sound travels faster through water than through air.", a: ["True", "False"], c:0, pts:100 },
            { id:9, d:"MEDIUM", t:"mc", q: "Which country has the most natural lakes in the world?", a: ["Canada", "Russia", "USA", "Finland"], c:0, pts:100 },
            { id:10, d:"MEDIUM", t:"tf", q: "True or False: A standard leap year has 366 days.", a: ["True", "False"], c:0, pts:100 },
            { id:11, d:"MEDIUM", t:"mc", q: "What is the square root of 225?", a: ["15", "12", "13", "25"], c:0, pts:100 },
            { id:12, d:"MEDIUM", t:"tf", q: "True or False: Lighting never strikes the same place twice.", a: ["True", "False"], c:1, pts:100 },
            { id:13, d:"MEDIUM", t:"mc", q: "In 2025, NASA's Europa Clipper reached which planet?", a: ["Jupiter", "Saturn", "Mars", "Neptune"], c:0, pts:100 },
            { id:14, d:"MEDIUM", t:"tf", q: "True or False: Bananas are technically classified as berries.", a: ["True", "False"], c:0, pts:100 },
            { id:15, d:"MEDIUM", t:"mc", q: "What is the largest country in the world by land area?", a: ["Russia", "Canada", "China", "USA"], c:0, pts:100 },
            { id:16, d:"MEDIUM", t:"tf", q: "True or False: A shrimp's heart is located in its head.", a: ["True", "False"], c:0, pts:100 },
            { id:17, d:"MEDIUM", t:"mc", q: "Which 2025 movie sequel returns to the planet Pandora?", a: ["Avatar: Fire and Ash", "Dune 3", "Star Wars", "Gladiator II"], c:0, pts:100 },
            { id:18, d:"MEDIUM", t:"tf", q: "True or False: Gold is the only metal that is naturally yellow.", a: ["True", "False"], c:1, pts:100 },
            { id:19, d:"MEDIUM", t:"mc", q: "Which city is known as the 'Big Apple'?", a: ["New York City", "London", "Los Angeles", "Chicago"], c:0, pts:100 },
            { id:20, d:"MEDIUM", t:"tf", q: "True or False: The Amazon River is the longest in the world.", a: ["True", "False"], c:1, pts:100 },

            // HARD (150)
            { id:50, d:"HARD", t:"mc", q: "Which physicist won the 2025 Nobel for Quantum Computing breakthroughs?", a: ["Michelle Simmons", "John Preskill", "Peter Shor", "David Deutsch"], c:0, pts:150 },
            { id:51, d:"HARD", t:"tf", q: "True or False: The Ottoman Empire officially dissolved in 1922.", a: ["True", "False"], c:0, pts:150 },
            { id:52, d:"HARD", t:"mc", q: "Which sea is the only one in the world without any land borders?", a: ["Sargasso Sea", "Caspian Sea", "Dead Sea", "Coral Sea"], c:0, pts:150 },
            { id:53, d:"HARD", t:"tf", q: "True or False: A nautical mile is longer than a standard mile.", a: ["True", "False"], c:0, pts:150 },
            { id:54, d:"HARD", t:"mc", q: "What is the capital of Kazakhstan, renamed back to its original name in 2022?", a: ["Astana", "Almaty", "Tashkent", "Bishkek"], c:0, pts:150 },
            { id:55, d:"HARD", t:"tf", q: "True or False: There are more trees on Earth than stars in the Milky Way.", a: ["True", "False"], c:0, pts:150 },
            { id:56, d:"HARD", t:"mc", q: "Which African country was formerly known as Abyssinia?", a: ["Ethiopia", "Sudan", "Ghana", "Kenya"], c:0, pts:150 },
            { id:57, d:"HARD", t:"tf", q: "True or False: A hummingbird's heart can beat over 1,000 times per minute.", a: ["True", "False"], c:0, pts:150 },
            { id:58, d:"HARD", t:"mc", q: "What is the smallest prime number greater than 100?", a: ["101", "103", "107", "109"], c:0, pts:150 },
            { id:59, d:"HARD", t:"tf", q: "True or False: The rarest human blood type is known as Rh-null.", a: ["True", "False"], c:0, pts:150 },
            { id:60, d:"HARD", t:"mc", q: "Which artist painted the 1931 surrealist masterpiece 'The Persistence of Memory'?", a: ["Salvador Dalí", "Pablo Picasso", "Vincent van Gogh", "Joan Miró"], c:0, pts:150 },
            { id:61, d:"HARD", t:"tf", q: "True or False: Mount Everest is the point on Earth closest to the Moon.", a: ["True", "False"], c:1, pts:150 },
            { id:62, d:"HARD", t:"mc", q: "What is the deepest known point in the world's oceans?", a: ["Challenger Deep", "Puerto Rico Trench", "Java Trench", "Tonga Trench"], c:0, pts:150 },
            { id:63, d:"HARD", t:"tf", q: "True or False: The Great Wall of China is visible from the Moon with the naked eye.", a: ["True", "False"], c:1, pts:150 },
            { id:64, d:"HARD", t:"mc", q: "Which billionaire duo led the 2025 DOGE advisory group?", a: ["Elon Musk & Vivek Ramaswamy", "Jeff Bezos & Bill Gates", "Tim Cook & Mark Zuckerberg", "Warren Buffett"], c:0, pts:150 },

            // SUPER HARD (200)
            { id:100, d:"SUPER HARD", t:"mc", q: "Which 1927 principle states position and momentum cannot be known simultaneously?", a: ["Heisenberg Uncertainty", "Pauli Exclusion", "Schrödinger's Equation", "Planck's Law"], c:0, pts:200 },
            { id:101, d:"SUPER HARD", t:"tf", q: "True or False: Venus rotates in the opposite direction of most other planets.", a: ["True", "False"], c:0, pts:200 },
            { id:102, d:"SUPER HARD", t:"mc", q: "What is the name of the only moon known to have its own magnetic field?", a: ["Ganymede", "Titan", "Europa", "Io"], c:0, pts:200 },
            { id:103, d:"SUPER HARD", t:"tf", q: "True or False: A day on Venus is longer than a year on Venus.", a: ["True", "False"], c:0, pts:200 },
            { id:104, d:"SUPER HARD", t:"mc", q: "Which chemical element has the highest melting point in its pure form?", a: ["Tungsten", "Carbon", "Osmium", "Platinum"], c:0, pts:200 },
            { id:105, d:"SUPER HARD", t:"tf", q: "True or False: The Kuiper Belt is located beyond the orbit of Neptune.", a: ["True", "False"], c:0, pts:200 },
            { id:106, d:"SUPER HARD", t:"mc", q: "Who was the first Byzantine Emperor to be crowned by a Pope in Rome?", a: ["None", "Justinian I", "Constantine", "Charlemagne"], c:0, pts:200 },
            { id:107, d:"SUPER HARD", t:"tf", q: "True or False: The total weight of all ants on Earth is roughly equal to all humans.", a: ["True", "False"], c:0, pts:200 },
            { id:108, d:"SUPER HARD", t:"mc", q: "In 2025, which island nation has the highest population density in the world?", a: ["Monaco", "Singapore", "Maldives", "Malta"], c:0, pts:200 },
            { id:109, d:"SUPER HARD", t:"tf", q: "True or False: Diamonds are the hardest material ever discovered.", a: ["True", "False"], c:1, pts:200 },
            { id:110, d:"SUPER HARD", t:"mc", q: "Which 19th-century novel begins with the line 'Call me Ishmael'?", a: ["Moby-Dick", "David Copperfield", "Treasure Island", "Heart of Darkness"], c:0, pts:200 },
            { id:111, d:"SUPER HARD", t:"tf", q: "True or False: Every human being spent about half an hour as a single cell.", a: ["True", "False"], c:0, pts:200 }

            // --- MEDIUM (100 PTS) CONTINUED ---
            { id: 21, d: "MEDIUM", t: "mc", q: "Which 2025 space mission aims to land the first woman on the Moon?", a: ["Artemis III", "Apollo 18", "Gateway 1", "Orion Prime"], c: 0, pts: 100 },
            { id: 22, d: "MEDIUM", t: "tf", q: "True or False: The 2025 TikTok ban in the US was officially signed into law in January.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 23, d: "MEDIUM", t: "mc", q: "Which country is home to the most natural pyramids in the world?", a: ["Sudan", "Egypt", "Mexico", "Peru"], c: 0, pts: 100 },
            { id: 24, d: "MEDIUM", t: "tf", q: "True or False: The human heart beats roughly 100,000 times per day.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 25, d: "MEDIUM", t: "mc", q: "Which element is the primary component of the Sun?", a: ["Hydrogen", "Helium", "Oxygen", "Carbon"], c: 0, pts: 100 },
            { id: 26, d: "MEDIUM", t: "tf", q: "True or False: Pineapples grow on trees.", a: ["True", "False"], c: 1, pts: 100 },
            { id: 27, d: "MEDIUM", t: "mc", q: "In 2025, which movie surpassed 'Avengers: Endgame' to become the 2nd highest grossing of all time?", a: ["Avatar 3", "Avatar 2", "Deadpool & Wolverine", "Inside Out 2"], c: 0, pts: 100 },
            { id: 28, d: "MEDIUM", t: "tf", q: "True or False: Sound travels faster in steel than in air.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 29, d: "MEDIUM", t: "mc", q: "What is the only state in the USA with a one-syllable name?", a: ["Maine", "Idaho", "Utah", "Texas"], c: 0, pts: 100 },
            { id: 30, d: "MEDIUM", t: "tf", q: "True or False: Sharks are mammals.", a: ["True", "False"], c: 1, pts: 100 },
            { id: 31, d: "MEDIUM", t: "mc", q: "What is the rarest naturally occurring element on Earth?", a: ["Astatine", "Francium", "Osmium", "Iridium"], c: 0, pts: 100 },
            { id: 32, d: "MEDIUM", t: "tf", q: "True or False: A cloud can weigh more than a million pounds.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 33, d: "MEDIUM", t: "mc", q: "Which 2025 athlete signed the largest sports contract in history?", a: ["Shohei Ohtani", "Lionel Messi", "Cristiano Ronaldo", "Patrick Mahomes"], c: 0, pts: 100 },
            { id: 34, d: "MEDIUM", t: "tf", q: "True or False: The Great Wall of China is longer than the diameter of the Earth.", a: ["True", "False"], c: 1, pts: 100 },
            { id: 35, d: "MEDIUM", t: "mc", q: "Which city will host the 2028 Summer Olympics?", a: ["Los Angeles", "Paris", "Brisbane", "Tokyo"], c: 0, pts: 100 },
            { id: 36, d: "MEDIUM", t: "tf", q: "True or False: A snail can sleep for up to three years.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 37, d: "MEDIUM", t: "mc", q: "What is the capital city of Norway?", a: ["Oslo", "Stockholm", "Copenhagen", "Helsinki"], c: 0, pts: 100 },
            { id: 38, d: "MEDIUM", t: "tf", q: "True or False: Humans share 50% of their DNA with bananas.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 39, d: "MEDIUM", t: "mc", q: "What is the most visited city in the world in 2025?", a: ["Istanbul", "Paris", "Bangkok", "London"], c: 0, pts: 100 },
            { id: 40, d: "MEDIUM", t: "tf", q: "True or False: The first domain name ever registered was symbolics.com.", a: ["True", "False"], c: 0, pts: 100 },

            // --- HARD (150 PTS) CONTINUED ---
            { id: 71, d: "HARD", t: "mc", q: "What is the only letter that does not appear in any US state name?", a: ["Q", "X", "Z", "J"], c: 0, pts: 150 },
            { id: 72, d: "HARD", t: "tf", q: "True or False: There are more people living in Tokyo than in the entire country of Canada.", a: ["True", "False"], c: 1, pts: 150 },
            { id: 73, d: "HARD", t: "mc", q: "Which 18th-century explorer was the first European to visit Hawaii?", a: ["James Cook", "Ferdinand Magellan", "Vasco da Gama", "Amerigo Vespucci"], c: 0, pts: 150 },
            { id: 74, d: "HARD", t: "tf", q: "True or False: The unicorn is the national animal of Scotland.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 75, d: "HARD", t: "mc", q: "In 2025, which company officially released the first commercial quantum computer for businesses?", a: ["IBM", "Google", "Microsoft", "Honeywell"], c: 0, pts: 150 },
            { id: 76, d: "HARD", t: "tf", q: "True or False: A deck of cards has 52 cards because there are 52 weeks in a year.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 77, d: "HARD", t: "mc", q: "What is the most common element in the Earth's crust?", a: ["Oxygen", "Silicon", "Aluminum", "Iron"], c: 0, pts: 150 },
            { id: 78, d: "HARD", t: "tf", q: "True or False: The statue of liberty was a gift from Italy.", a: ["True", "False"], c: 1, pts: 150 },
            { id: 79, d: "HARD", t: "mc", q: "Who was the last Tsar of Russia?", a: ["Nicholas II", "Alexander III", "Peter the Great", "Ivan the Terrible"], c: 0, pts: 150 },
            { id: 80, d: "HARD", t: "tf", q: "True or False: Your brain uses more energy than any other organ.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 81, d: "HARD", t: "mc", q: "Which 2025 Nobel Prize in Physics winner predicted the first AI-driven fusion reactor?", a: ["Demis Hassabis", "John Hopfield", "Geoffrey Hinton", "Arthur McDonald"], c: 0, pts: 150 },
            { id: 82, d: "HARD", t: "tf", q: "True or False: The planet Neptune was discovered by mathematical prediction before it was seen by telescope.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 83, d: "HARD", t: "mc", q: "What is the largest island in the world?", a: ["Greenland", "New Guinea", "Borneo", "Madagascar"], c: 0, pts: 150 },
            { id: 84, d: "HARD", t: "tf", q: "True or False: Gold can be found on every continent on Earth.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 85, d: "HARD", t: "mc", q: "What is the chemical symbol for Tungsten?", a: ["W", "T", "Tn", "Tg"], c: 0, pts: 150 },
            { id: 86, d: "HARD", t: "tf", q: "True or False: There are no clocks in Las Vegas casinos.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 87, d: "HARD", t: "mc", q: "Which country has the highest life expectancy in 2025?", a: ["Monaco", "Japan", "Switzerland", "Singapore"], c: 0, pts: 150 },
            { id: 88, d: "HARD", t: "tf", q: "True or False: One teaspoon of a neutron star would weigh 6 billion tons.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 89, d: "HARD", t: "mc", q: "Who developed the first polio vaccine in 1955?", a: ["Jonas Salk", "Albert Sabin", "Louis Pasteur", "Edward Jenner"], c: 0, pts: 150 },
            { id: 90, d: "HARD", t: "tf", q: "True or False: A year on Uranus is 84 Earth years long.", a: ["True", "False"], c: 0, pts: 150 },

            // --- SUPER HARD (200 PTS) CONTINUED ---
            { id: 150, d: "SUPER HARD", t: "mc", q: "In 2025, a missing painting by which artist was found behind a wall in an Italian attic?", a: ["Caravaggio", "Botticelli", "Raphael", "Titian"], c: 0, pts: 200 },
            { id: 151, d: "SUPER HARD", t: "tf", q: "True or False: The human body contains enough carbon to lead 9,000 pencils.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 152, d: "SUPER HARD", t: "mc", q: "Which ancient empire was the first to use a base-60 numbering system (origin of 60 seconds/minutes)?", a: ["Sumerians", "Egyptians", "Mayans", "Romans"], c: 0, pts: 200 },
            { id: 153, d: "SUPER HARD", t: "tf", q: "True or False: At the deepest part of the ocean, the water pressure is equivalent to one person trying to support 50 jumbo jets.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 154, d: "SUPER HARD", t: "mc", q: "What is the only letter not found in the Periodic Table of Elements?", a: ["J", "Q", "X", "Z"], c: 0, pts: 200 },
            { id: 155, d: "SUPER HARD", t: "tf", q: "True or False: Every odd number has the letter 'e' in it.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 156, d: "SUPER HARD", t: "mc", q: "Which linguist first proposed the theory of Universal Grammar?", a: ["Noam Chomsky", "Ferdinand de Saussure", "Steven Pinker", "Edward Sapir"], c: 0, pts: 200 },
            { id: 157, d: "SUPER HARD", t: "tf", q: "True or False: Venus is the only planet that rotates clockwise.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 158, d: "SUPER HARD", t: "mc", q: "In 2025, scientists confirmed that the Earth's inner core has begun to rotate in which direction relative to the surface?", a: ["Backward (East to West)", "Faster", "Slower", "It has stopped entirely"], c: 0, pts: 200 },
            { id: 159, d: "SUPER HARD", t: "tf", q: "True or False: There is a species of jellyfish that is biologically immortal.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 160, d: "SUPER HARD", t: "mc", q: "Which 17th-century mathematical theorem was finally proven in 1994 by Andrew Wiles?", a: ["Fermat's Last Theorem", "Goldbach's Conjecture", "Riemann Hypothesis", "Poincaré Conjecture"], c: 0, pts: 200 },
            { id: 161, d: "SUPER HARD", t: "tf", q: "True or False: A lightning bolt is five times hotter than the surface of the sun.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 162, d: "SUPER HARD", t: "mc", q: "What is the name of the phenomenon where a particle can exist in two places at once?", a: ["Superposition", "Entanglement", "Tunneling", "Decoherence"], c: 0, pts: 200 },
            { id: 163, d: "SUPER HARD", t: "tf", q: "True or False: The first programmable computer was designed in the 1830s.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 164, d: "SUPER HARD", t: "mc", q: "What is the most expensive spice in the world by weight?", a: ["Saffron", "Vanilla", "Cardamom", "Cinnamon"], c: 0, pts: 200 },
            { id: 165, d: "SUPER HARD", t: "tf", q: "True or False: You can't hum while holding your nose.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 166, d: "SUPER HARD", t: "mc", q: "Which battle in 1815 ended Napoleon Bonaparte's rule?", a: ["Battle of Waterloo", "Battle of Austerlitz", "Battle of Leipzig", "Battle of Borodino"], c: 0, pts: 200 },
            { id: 167, d: "SUPER HARD", t: "tf", q: "True or False: Cleopatria lived closer in time to the Moon Landing than to the building of the Great Pyramids.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 168, d: "SUPER HARD", t: "mc", q: "What is the largest known structure in the observable universe?", a: ["Hercules-Corona Borealis Wall", "Sloan Great Wall", "Huge-LQG", "IC 1101"], c: 0, pts: 200 },
            { id: 169, d: "SUPER HARD", t: "tf", q: "True or False: Oxford University is older than the Aztec Empire.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 170, d: "SUPER HARD", t: "mc", q: "What is the name of the point in space where gravity is so strong that even light cannot escape?", a: ["Event Horizon", "Singularity", "Schwarzschild Radius", "Accretion Disk"], c: 1, pts: 200 }

        // --- MEDIUM (100 PTS) CONTINUED ---
            { id: 301, d: "MEDIUM", t: "mc", q: "Which 2025 film became the first 'R-rated' movie to win the Golden Globe for Best Picture - Musical or Comedy?", a: ["Deadpool & Wolverine", "The Brutalist", "Anora", "A Real Pain"], c: 2, pts: 100 },
            { id: 302, d: "MEDIUM", t: "tf", q: "True or False: In 2025, the moon experienced its first permanent human-occupied base as part of the Artemis program.", a: ["True", "False"], c: 1, pts: 100 },
            { id: 303, d: "MEDIUM", t: "mc", q: "What is the only country in the world that is also a continent?", a: ["Australia", "Antarctica", "Greenland", "Iceland"], c: 0, pts: 100 },
            { id: 304, d: "MEDIUM", t: "tf", q: "True or False: The 2025 Summer Solstice occurred on June 21st.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 305, d: "MEDIUM", t: "mc", q: "Which animal has the highest blood pressure in the world?", a: ["Giraffe", "Blue Whale", "Elephant", "Cheetah"], c: 0, pts: 100 },
            { id: 306, d: "MEDIUM", t: "tf", q: "True or False: A group of flamingos is called a 'flamboyance'.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 307, d: "MEDIUM", t: "mc", q: "Which 2025 tech company overtook Apple as the world's most valuable company for three months?", a: ["Nvidia", "Microsoft", "Amazon", "Alphabet"], c: 0, pts: 100 },
            { id: 308, d: "MEDIUM", t: "tf", q: "True or False: Honey never spoils.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 309, d: "MEDIUM", t: "mc", q: "What is the smallest country in the world by land area?", a: ["Vatican City", "Monaco", "San Marino", "Liechtenstein"], c: 0, pts: 100 },
            { id: 310, d: "MEDIUM", t: "tf", q: "True or False: The 2025 total solar eclipse was visible from the United Kingdom.", a: ["True", "False"], c: 1, pts: 100 },
            { id: 311, d: "MEDIUM", t: "mc", q: "What is the main component of glass?", a: ["Sand/Silica", "Salt", "Lime", "Lead"], c: 0, pts: 100 },
            { id: 312, d: "MEDIUM", t: "tf", q: "True or False: Bananas grow pointing upwards.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 313, d: "MEDIUM", t: "mc", q: "Which 2025 athlete won their 25th Grand Slam title, breaking the all-time record?", a: ["Novak Djokovic", "Rafael Nadal", "Carlos Alcaraz", "Jannik Sinner"], c: 0, pts: 100 },
            { id: 314, d: "MEDIUM", t: "tf", q: "True or False: A human has the same number of neck vertebrae as a giraffe.", a: ["True", "False"], c: 0, pts: 100 },
            { id: 315, d: "MEDIUM", t: "mc", q: "What is the capital city of Switzerland?", a: ["Bern", "Zurich", "Geneva", "Basel"], c: 0, pts: 100 },
            { id: 316, d: "MEDIUM", t: "tf", q: "True or False: Water is more dense as a solid than as a liquid.", a: ["True", "False"], c: 1, pts: 100 },
            { id: 317, d: "MEDIUM", t: "mc", q: "Who wrote the novel '1984'?", a: ["George Orwell", "Aldous Huxley", "Ray Bradbury", "H.G. Wells"], c: 0, pts: 100 },
            { id: 318, d: "MEDIUM", t: "tf", q: "True or False: The 2025 Cricket World Cup was held in the United States and West Indies.", a: ["True", "False"], c: 1, pts: 100 },
            { id: 319, d: "MEDIUM", t: "mc", q: "Which 2025 hurricane became the earliest Category 5 on record in the Atlantic?", a: ["Beryl", "Milton", "Helene", "Isaac"], c: 0, pts: 100 },
            { id: 320, d: "MEDIUM", t: "tf", q: "True or False: Lightning is hotter than the surface of the sun.", a: ["True", "False"], c: 0, pts: 100 },

            // --- HARD (150 PTS) CONTINUED ---
            { id: 401, d: "HARD", t: "mc", q: "Which 2025 Nobel Prize in Chemistry winner discovered the method to create 'living' plastics?", a: ["Zhenan Bao", "K. Barry Sharpless", "Omar Yaghi", "Carolyn Bertozzi"], c: 0, pts: 150 },
            { id: 402, d: "HARD", t: "tf", q: "True or False: In 2025, the Earth's population officially surpassed 9 billion people.", a: ["True", "False"], c: 1, pts: 150 },
            { id: 403, d: "HARD", t: "mc", q: "What is the world's largest non-continental island?", a: ["Greenland", "New Guinea", "Borneo", "Madagascar"], c: 0, pts: 150 },
            { id: 404, d: "HARD", t: "tf", q: "True or False: The Great Wall of China is roughly 13,000 miles long.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 405, d: "HARD", t: "mc", q: "Which 2025 SpaceX mission carried the first civilian crew to orbit the Earth's poles?", a: ["Fram2", "Polaris Dawn", "Inspiration4", "DearMoon"], c: 0, pts: 150 },
            { id: 406, d: "HARD", t: "tf", q: "True or False: An octopus can 'taste' with its arms.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 407, d: "HARD", t: "mc", q: "What is the rarest natural color for a diamond?", a: ["Red", "Blue", "Green", "Pink"], c: 0, pts: 150 },
            { id: 408, d: "HARD", t: "tf", q: "True or False: The driest place on Earth is in Antarctica.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 409, d: "HARD", t: "mc", q: "Who was the first Roman Emperor to convert to Christianity?", a: ["Constantine the Great", "Augustus", "Nero", "Marcus Aurelius"], c: 0, pts: 150 },
            { id: 410, d: "HARD", t: "tf", q: "True or False: Sound travels roughly 4 times faster in water than in air.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 411, d: "HARD", t: "mc", q: "Which 2025 archaeological discovery in Egypt revealed the tomb of a previously unknown High Priest of the Sun?", a: ["Abusir", "Saqqara", "Luxor", "Giza"], c: 0, pts: 150 },
            { id: 412, d: "HARD", t: "tf", q: "True or False: Every continent on Earth has a city named Rome.", a: ["True", "False"], c: 1, pts: 150 },
            { id: 413, d: "HARD", t: "mc", q: "Which element has the highest melting point of any metal?", a: ["Tungsten", "Carbon", "Titanium", "Osmium"], c: 0, pts: 150 },
            { id: 414, d: "HARD", t: "tf", q: "True or False: The oldest living tree on Earth is over 4,800 years old.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 415, d: "HARD", t: "mc", q: "Which 2025 US state became the first to implement a 'Carbon Tax' on all non-electric vehicles?", a: ["Washington", "California", "New York", "Massachusetts"], c: 0, pts: 150 },
            { id: 416, d: "HARD", t: "tf", q: "True or False: Venus is the only planet that doesn't have any moons.", a: ["True", "False"], c: 1, pts: 150 },
            { id: 417, d: "HARD", t: "mc", q: "What is the capital of Mongolia?", a: ["Ulaanbaatar", "Astana", "Tashkent", "Bishkek"], c: 0, pts: 150 },
            { id: 418, d: "HARD", t: "tf", q: "True or False: The 'Mona Lisa' has no eyebrows.", a: ["True", "False"], c: 0, pts: 150 },
            { id: 419, d: "HARD", t: "mc", q: "Which 2025 physicist proved the 'Gravitational Wave Background' using pulsar timing?", a: ["The NANOGrav Team", "Stephen Hawking", "Kip Thorne", "Roger Penrose"], c: 0, pts: 150 },
            { id: 420, d: "HARD", t: "tf", q: "True or False: Polar bears have black skin.", a: ["True", "False"], c: 0, pts: 150 },

            // --- SUPER HARD (200 PTS) CONTINUED ---
            { id: 501, d: "SUPER HARD", t: "mc", q: "In 2025, a new 'standard model' of physics was proposed to account for the unexpected behavior of which particle?", a: ["Muon", "Quark", "Neutrino", "Higgs Boson"], c: 0, pts: 200 },
            { id: 502, d: "SUPER HARD", t: "tf", q: "True or False: In 2025, the 'Doomsday Clock' was moved back to its furthest point from midnight since 1991.", a: ["True", "False"], c: 1, pts: 200 },
            { id: 503, d: "SUPER HARD", t: "mc", q: "Which 14th-century explorer traveled further than Marco Polo, visiting most of the known Islamic world?", a: ["Ibn Battuta", "Zheng He", "Vasco da Gama", "John Cabot"], c: 0, pts: 200 },
            { id: 504, d: "SUPER HARD", t: "tf", q: "True or False: The speed of light through a diamond is less than half its speed through a vacuum.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 505, d: "SUPER HARD", t: "mc", q: "Which 2025 subatomic discovery confirmed the existence of 'Glueballs' (particles made entirely of force)?", a: ["CERN / LHC", "FermiLab", "SLAC", "Brookhaven"], c: 0, pts: 200 },
            { id: 506, d: "SUPER HARD", t: "tf", q: "True or False: A day on the Moon is exactly 24 hours long.", a: ["True", "False"], c: 1, pts: 200 },
            { id: 507, d: "SUPER HARD", t: "mc", q: "What is the only mammal that is known to be capable of truly powered flight?", a: ["Bat", "Flying Squirrel", "Sugar Glider", "Colugo"], c: 0, pts: 200 },
            { id: 508, d: "SUPER HARD", t: "tf", q: "True or False: The human eye can distinguish over 10 million different colors.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 509, d: "SUPER HARD", t: "mc", q: "In 2025, the 'Voyager 1' spacecraft officially sent its last readable signal from how many billions of miles away?", a: ["15 Billion", "10 Billion", "20 Billion", "25 Billion"], c: 0, pts: 200 },
            { id: 510, d: "SUPER HARD", t: "tf", q: "True or False: Every single odd number squared results in an odd number.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 511, d: "SUPER HARD", t: "mc", q: "Which ancient civilization developed the concept of 'Zero' independently of India?", a: ["Mayans", "Egyptians", "Greeks", "Chinese"], c: 0, pts: 200 },
            { id: 512, d: "SUPER HARD", t: "tf", q: "True or False: Some species of sharks can live for over 400 years.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 513, d: "SUPER HARD", t: "mc", q: "What is the largest known prime number discovered by a 2025 AI-distributed computing project?", a: ["M136279841", "M82589933", "M77232917", "M74207281"], c: 0, pts: 200 },
            { id: 514, d: "SUPER HARD", t: "tf", q: "True or False: Your stomach acid is strong enough to dissolve stainless steel.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 515, d: "SUPER HARD", t: "mc", q: "In 2025, which nation was the first to implement a 'Global AI Safety Treaty' into its national constitution?", a: ["United Kingdom", "United States", "Switzerland", "Japan"], c: 0, pts: 200 },
            { id: 516, d: "SUPER HARD", t: "tf", q: "True or False: The planet Saturn would float if you put it in a giant bathtub of water.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 517, d: "SUPER HARD", t: "mc", q: "Which composer wrote the 1893 'New World Symphony'?", a: ["Antonin Dvorak", "Gustav Mahler", "Pyotr Tchaikovsky", "Johannes Brahms"], c: 0, pts: 200 },
            { id: 518, d: "SUPER HARD", t: "tf", q: "True or False: The first laser was built in 1960.", a: ["True", "False"], c: 0, pts: 200 },
            { id: 519, d: "SUPER HARD", t: "mc", q: "In 2025, what was the name of the first generative AI model to 'pass' the Turing Test in a double-blind public experiment?", a: ["GPT-5", "Claude 4", "Gemini 2 Ultra", "Llama 4"], c: 0, pts: 200 },
            { id: 520, d: "SUPER HARD", t: "tf", q: "True or False: There is a species of ant that uses its own body to build a bridge for its colony.", a: ["True", "False"], c: 0, pts: 200 }
        ];

        // AUDIO ENGINE
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSfx(freq, type, dur, vol = 0.1) {
            const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
            osc.type = type; osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime); gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + dur);
            osc.connect(gain); gain.connect(audioCtx.destination); osc.start(); osc.stop(audioCtx.currentTime + dur);
        }
        const sfx = {
            correct: () => { playSfx(600, 'sine', 0.2); setTimeout(()=>playSfx(800, 'sine', 0.3), 100); },
            wrong: () => { playSfx(150, 'square', 0.4); },
            tick: () => playSfx(1000, 'sine', 0.05, 0.02),
            steal: () => { playSfx(440, 'triangle', 0.2); setTimeout(()=>playSfx(440, 'triangle', 0.2), 200); },
            win: () => { [440, 554, 659, 880].forEach((f, i) => setTimeout(()=>playSfx(f, 'sawtooth', 0.5), i*150)); }
        };

        // GAME STATE
        let state = { active: false, scores: [0,0,0,0], numTeams: 2, set: [], qIdx: 0, turn: 0, isSteal: false, timeLeft: 30, paused: false, usedIds: [] };
        let setup = { teams: 2, perTier: 5 };

        function setTeams(n) {
            setup.teams = n;
            document.querySelectorAll('.team-btn').forEach(b => b.classList.remove('selected-btn'));
            event.target.classList.add('selected-btn');
            checkReady();
        }

        function setLength(n) {
            setup.perTier = n;
            document.querySelectorAll('.len-btn').forEach(b => b.classList.remove('selected-btn'));
            event.target.classList.add('selected-btn');
            checkReady();
        }

        function checkReady() {
            if(document.querySelectorAll('.selected-btn').length === 2) document.getElementById('start-btn').classList.remove('hidden');
        }

        function shuffle(a) { for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } return a; }

        window.onload = () => {
            const saved = localStorage.getItem('ot_v_ultimate');
            const used = localStorage.getItem('ot_history_ids');
            if(used) state.usedIds = JSON.parse(used);
            if(saved) {
                Object.assign(state, JSON.parse(saved));
                if(state.active) document.getElementById('resume-container').classList.remove('hidden');
            }
            updateBankStatus();
        };

        function updateBankStatus() {
            const rem = masterPool.length - state.usedIds.length;
            document.getElementById('bank-status').innerText = `History: ${state.usedIds.length} Used | Bank: ${rem} Remaining`;
        }

        function initGame(isNew) {
            if(isNew) {
                const avail = masterPool.filter(q => !state.usedIds.includes(q.id));
                if(avail.length < (setup.perTier * 3)) {
                    alert("Bank empty! Resetting history.");
                    state.usedIds = []; localStorage.removeItem('ot_history_ids');
                    return initGame(true);
                }
                const m = shuffle(avail.filter(x => x.d === "MEDIUM")).slice(0, setup.perTier);
                const h = shuffle(avail.filter(x => x.d === "HARD")).slice(0, setup.perTier);
                const sh = shuffle(avail.filter(x => x.d === "SUPER HARD")).slice(0, setup.perTier);
                state.set = [...m, ...h, ...sh];
                state.scores = [0,0,0,0]; state.qIdx = 0; state.turn = 0; state.numTeams = setup.teams; state.active = true;
            }
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('main-ui').classList.remove('hidden');
            renderScoreboard(); loadQ();
        }

        function renderScoreboard() {
            const sb = document.getElementById('scoreboard');
            sb.innerHTML = '';
            for(let i=0; i < state.numTeams; i++) {
                sb.innerHTML += `<div id="card-${i}" class="team-card">TEAM ${i+1}: <span id="score-${i}">${state.scores[i]}</span></div>`;
            }
        }

        function loadQ() {
            clearInterval(state.timer);
            const q = state.set[state.qIdx];
            if(!q) { end(); return; }
            state.timeLeft = state.isSteal ? 15 : 30;
            state.paused = false;
            document.getElementById('reveal-screen').classList.add('hidden');
            document.getElementById('correct-flash').classList.add('hidden');
            document.getElementById('diff-header').innerText = q.d;
            document.getElementById('question-display').innerText = q.q;
            document.getElementById('steal-msg').className = state.isSteal ? 'steal-txt' : 'hidden';
            if(state.isSteal) sfx.steal();
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            q.a.forEach((opt, i) => {
                const b = document.createElement('button');
                b.className = 'btn-opt'; b.innerText = opt;
                b.onclick = () => check(i); grid.appendChild(b);
            });
            updateActiveCard(); startTimer();
        }

        function startTimer() {
            state.timer = setInterval(() => {
                if(!state.paused) {
                    state.timeLeft -= 0.1;
                    if(state.timeLeft <= 5 && state.timeLeft > 0 && Math.abs(state.timeLeft % 1) < 0.1) sfx.tick();
                    document.getElementById('timer-bar').style.width = (state.timeLeft / (state.isSteal ? 15 : 30) * 100) + "%";
                    if(state.timeLeft <= 0) handlePass();
                }
            }, 100);
        }

        function check(i) {
            const q = state.set[state.qIdx];
            if(i === q.c) {
                sfx.correct(); state.scores[state.turn] += q.pts;
                if(!state.usedIds.includes(q.id)) state.usedIds.push(q.id);
                flashCorrect(q.pts);
            } else {
                sfx.wrong();
                // NO STEAL FOR TRUE/FALSE
                if(!state.isSteal && q.t === 'mc') {
                    state.scores[state.turn] -= q.pts;
                    state.isSteal = true; state.turn = (state.turn + 1) % state.numTeams;
                    loadQ();
                } else {
                    if(!state.usedIds.includes(q.id)) state.usedIds.push(q.id);
                    reveal();
                }
            }
        }

        function flashCorrect(p) {
            clearInterval(state.timer);
            document.getElementById('pts-added').innerText = `+${p} PTS`;
            document.getElementById('correct-flash').classList.remove('hidden');
            setTimeout(next, 1200);
        }

        function handlePass() {
            const q = state.set[state.qIdx];
            if(!state.isSteal && q.t === 'mc') {
                state.isSteal = true; state.turn = (state.turn + 1) % state.numTeams;
                loadQ();
            } else {
                if(!state.usedIds.includes(q.id)) state.usedIds.push(q.id);
                reveal(); 
            }
        }

        function reveal() {
            clearInterval(state.timer);
            const q = state.set[state.qIdx];
            document.getElementById('reveal-text').innerText = q.a[q.c];
            document.getElementById('reveal-screen').classList.remove('hidden');
            setTimeout(next, 4000);
        }

        function next() {
            state.qIdx++; state.isSteal = false; 
            state.turn = state.qIdx % state.numTeams;
            if(state.qIdx < state.set.length) loadQ(); else end();
            save();
        }

        function updateActiveCard() {
            for(let i=0; i<state.numTeams; i++) {
                const c = document.getElementById(`card-${i}`);
                if(c) {
                    c.className = 'team-card' + (state.turn === i ? ` active-${i}` : '');
                    document.getElementById(`score-${i}`).innerText = state.scores[i];
                }
            }
            document.getElementById('progress-fill').style.width = (state.qIdx / state.set.length * 100) + "%";
        }

        function end() {
            state.active = false; sfx.win();
            document.getElementById('main-ui').classList.add('hidden');
            document.getElementById('end-screen').classList.remove('hidden');
            let max = -9999; let winner = 0;
            state.scores.slice(0, state.numTeams).forEach((s, idx) => { if(s > max){ max = s; winner = idx + 1; } });
            document.getElementById('winner-text').innerText = `TEAM ${winner} WINS!`;
            confetti({ particleCount: 500, spread: 100, origin: { y: 0.6 } });
            save();
        }

        function togglePause() { state.paused = !state.paused; document.getElementById('pause-btn').innerText = state.paused ? "RESUME" : "PAUSE"; }
        function save() { localStorage.setItem('ot_v_ultimate', JSON.stringify(state)); localStorage.setItem('ot_history_ids', JSON.stringify(state.usedIds)); }
        function fullReset() { if(confirm("Wipe bank and scores?")) { localStorage.clear(); location.reload(); } }
    </script>
</body>
</html>
