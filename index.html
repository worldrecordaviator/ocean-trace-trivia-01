<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025/26 Ocean Trace: New Years Final</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root { --team-a: #ff4757; --team-b: #3742fa; --bg: #0f172a; --text: #f8fafc; --accent: #f59e0b; --correct: #22c55e; }
        body { font-family: sans-serif; background-color: var(--bg); color: var(--text); margin: 0; text-align: center; overflow: hidden; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        #game-container { width: 95%; max-width: 1200px; padding: 20px; }
        .scoreboard { display: flex; justify-content: space-around; margin-bottom: 20px; }
        .team-card { padding: 20px; border-radius: 20px; font-size: 3rem; min-width: 300px; border: 10px solid transparent; background: rgba(255,255,255,0.05); transition: 0.3s; }
        .active-a { border-color: var(--team-a); box-shadow: 0 0 50px var(--team-a); transform: scale(1.05); }
        .active-b { border-color: var(--team-b); box-shadow: 0 0 50px var(--team-b); transform: scale(1.05); }
        #question-display { font-size: 2.5rem; margin: 20px 0; min-height: 120px; font-weight: bold; }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .btn-opt { background: #1e293b; border: 4px solid #475569; color: white; padding: 25px; font-size: 1.8rem; border-radius: 15px; cursor: pointer; }
        .timer-container { width: 100%; height: 25px; background: #1e293b; margin-top: 30px; border-radius: 50px; border: 3px solid #334155; overflow: hidden; }
        #timer-bar { width: 100%; height: 100%; background: var(--accent); transition: width 0.1s linear; }
        .blurry-box { height: 350px; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; }
        #blurry-img { max-height: 100%; border-radius: 20px; filter: blur(60px); transition: filter 0.5s ease; }
        #input-box { font-size: 3rem; padding: 15px; width: 80%; border-radius: 15px; border: 5px solid #475569; background: #0f172a; color: white; text-align: center; }
        .reveal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 99; }
        .reveal-ans { font-size: 6rem; color: var(--correct); text-shadow: 0 0 30px var(--correct); text-transform: uppercase; margin-top: 20px; }
        .hidden { display: none !important; }
        .steal-msg { color: var(--accent); font-size: 2.5rem; font-weight: bold; animation: blinker 1s infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
    </style>
</head>
<body>
    <div id="game-container">
        <!-- Start Screen -->
        <div id="start-screen">
            <h1 style="font-size: 5rem; margin: 0;">2025/26</h1>
            <h2 style="color:var(--accent); font-size: 3rem;">OCEAN TRACE TRIVIA</h2>
            <button class="btn-opt" onclick="initGame()" style="padding: 40px 80px; font-size: 3.5rem; border-color: var(--accent);">START GAME</button>
            <br><br>
            <button onclick="fullReset()" style="background:none; border:none; color:#444; cursor:pointer; text-decoration:underline;">[Emergency Reset Game]</button>
        </div>

        <!-- Main Game UI -->
        <div id="main-ui" class="hidden">
            <div class="scoreboard">
                <div id="card-a" class="team-card">A: <span id="score-a">0</span></div>
                <div id="card-b" class="team-card">B: <span id="score-b">0</span></div>
            </div>
            <div id="steal-label" class="steal-msg hidden">STEAL OPPORTUNITY!</div>
            <div id="visual-container" class="blurry-box hidden">
                <img id="blurry-img" src="" onerror="this.src='https://via.placeholder.com/400?text=Image+Loading...';">
            </div>
            <div id="question-display"></div>
            <div id="multiple-choice" class="options-grid"></div>
            <div id="typing-input" class="hidden">
                <input type="text" id="input-box" placeholder="TYPE & PRESS ENTER..." autocomplete="off">
            </div>
            <div class="timer-container"><div id="timer-bar"></div></div>
            <div style="margin-top:20px;">
                <button class="btn-opt" style="font-size:1.2rem; padding:10px 30px; background:#475569;" onclick="handlePass()">PASS / TIME</button>
                <button id="pause-btn" class="btn-opt" style="font-size:1.2rem; padding:10px 30px; background:var(--accent);" onclick="togglePause()">PAUSE</button>
            </div>
        </div>

        <!-- Reveal Screen -->
        <div id="reveal-screen" class="reveal-overlay hidden">
            <h2 style="font-size: 2.5rem;">THE ANSWER WAS:</h2>
            <div id="reveal-text" class="reveal-ans"></div>
            <div id="reveal-img-box" style="margin-top: 20px; height: 350px;"></div>
        </div>

        <!-- End Screen -->
        <div id="end-screen" class="hidden">
            <h1 id="winner-text" style="font-size: 6rem; color: var(--accent);"></h1>
            <button class="btn-opt" onclick="fullReset()">PLAY AGAIN</button>
        </div>
    </div>

    <script>
        const masterPool = [
            { d:1, q: "Identify the GLOBAL LOGO", type: "text", ans: "nike", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a6/Logo_NIKE.svg/600px-Logo_NIKE.svg.png", pts: 200 },
            { d:1, q: "What is the capital of Florida?", a: ["Tallahassee", "Miami", "Orlando", "Tampa"], c: 0, pts: 100 },
            { d:1, q: "Identify the ANIMAL", type: "text", ans: "elephant", img: "https://images.unsplash.com/photo-1557050543-4d5f4e07ef46?w=600", pts: 200 },
            { d:1, q: "Which movie sequel returned to Pandora in 2025?", a: ["Avatar: Fire and Ash", "Dune 3", "Star Wars", "Gladiator II"], c: 0, pts: 100 },
            { d:1, q: "Identify the LOGO", type: "text", ans: "mcdonalds", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/McDonald%27s_Golden_Arches.svg/600px-McDonald%27s_Golden_Arches.svg.png", pts: 200 },
            { d:1, q: "Who performed at the 2025 Super Bowl Halftime show?", a: ["Kendrick Lamar", "Taylor Swift", "Post Malone", "Drake"], c: 0, pts: 100 },
            { d:1, q: "Identify the ANIMAL", type: "text", ans: "lion", img: "https://images.unsplash.com/photo-1546182990-dffeafbe841d?w=600", pts: 200 },
            { d:1, q: "What is the largest ocean on Earth?", a: ["Pacific", "Atlantic", "Indian", "Arctic"], c: 0, pts: 100 },
            { d:1, q: "Identify the OBJECT", type: "text", ans: "guitar", img: "https://images.unsplash.com/photo-1550291652-6ea9114a47b1?w=600", pts: 200 },
            { d:1, q: "Identify the LOGO", type: "text", ans: "apple", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Apple_logo_black.svg/400px-Apple_logo_black.svg.png", pts: 200 },
            { d:2, q: "Identify the ANIMAL", type: "text", ans: "sloth", img: "https://images.unsplash.com/photo-1516734212186-a967f81ad0d7?w=600", pts: 300 },
            { d:2, q: "In 2025, which nation officially moved its capital?", a: ["Indonesia", "Kiribati", "Maldives", "Tuvalu"], c: 0, pts: 250 },
            { d:2, q: "Identify the LOGO", type: "text", ans: "tesla", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Tesla_T_Free.svg/400px-Tesla_T_Free.svg.png", pts: 300 },
            { d:2, q: "What is the capital of Australia?", a: ["Canberra", "Sydney", "Melbourne", "Perth"], c: 0, pts: 250 },
            { d:2, q: "Identify the OBJECT", type: "text", ans: "telescope", img: "https://images.unsplash.com/photo-1614332284145-812036437d0c?w=600", pts: 300 },
            { d:2, q: "Which company hit 4 Trillion in market cap in 2025?", a: ["Nvidia", "Apple", "Microsoft", "Google"], c: 0, pts: 250 },
            { d:2, q: "Identify the ANIMAL", type: "text", ans: "platypus", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4b/Platypus-sketch.jpg/600px-Platypus-sketch.jpg", pts: 300 },
            { d:3, q: "Identify the ANIMAL", type: "text", ans: "pangolin", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Manis_temminckii_1.jpg/600px-Manis_temminckii_1.jpg", pts: 600 },
            { d:3, q: "What is the only sea in the world with no land border?", a: ["Sargasso Sea", "Caspian Sea", "Dead Sea", "Coral Sea"], c: 0, pts: 500 },
            { d:3, q: "Identify the OBJECT", type: "text", ans: "sextant", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d4/Sextant_1.jpg/600px-Sextant_1.jpg", pts: 600 }
        ];

        let state = { scores: [0, 0], set: [], qIdx: 0, turn: 0, isSteal: false, timeLeft: 30, paused: false, active: false, blur: 60, reveal: false };

        function clean(s) { 
            let res = s.toString().toLowerCase().trim().replace(/[^a-z0-9]/g, '');
            if(res.startsWith("the")) res = res.substring(3);
            return res; 
        }

        window.onload = () => {
            const saved = localStorage.getItem('ot_v7');
            if(saved) {
                state = JSON.parse(saved);
                if(state.active) {
                    document.getElementById('start-screen').classList.add('hidden');
                    document.getElementById('main-ui').classList.remove('hidden');
                    render(); loadQ();
                }
            }
            document.getElementById('input-box').addEventListener('keypress', (e) => { if (e.key === 'Enter') checkTyped(); });
        };

        function initGame() {
            const shuf = (a) => a.sort(() => 0.5 - Math.random());
            const e = shuf(masterPool.filter(x => x.d === 1)).slice(0, 10);
            const m = shuf(masterPool.filter(x => x.d === 2)).slice(0, 10);
            const h = shuf(masterPool.filter(x => x.d === 3)).slice(0, 10);
            state.set = [...e, ...m, ...h];
            state.active = true;
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('main-ui').classList.remove('hidden');
            loadQ(); save();
        }

        function loadQ() {
            clearInterval(state.timer);
            const q = state.set[state.qIdx];
            if(!q) { end(); return; }
            state.timeLeft = state.isSteal ? 15 : 30;
            state.blur = 60; state.reveal = false;
            document.getElementById('reveal-screen').classList.add('hidden');
            document.getElementById('question-display').innerText = q.q;
            document.getElementById('steal-label').className = state.isSteal ? 'steal-msg' : 'hidden';
            const bImg = document.getElementById('blurry-img');
            if(q.img) {
                document.getElementById('visual-container').classList.remove('hidden');
                bImg.src = q.img; bImg.style.filter = `blur(${state.blur}px)`;
            } else { document.getElementById('visual-container').classList.add('hidden'); }
            const mc = document.getElementById('multiple-choice');
            const ty = document.getElementById('typing-input');
            mc.innerHTML = '';
            if(q.type === 'text') {
                mc.classList.add('hidden'); ty.classList.remove('hidden');
                document.getElementById('input-box').value = ''; document.getElementById('input-box').focus();
            } else {
                mc.classList.remove('hidden'); ty.classList.add('hidden');
                q.a.forEach((opt, i) => {
                    const b = document.createElement('button');
                    b.className = 'btn-opt'; b.innerText = opt;
                    b.onclick = () => checkMC(i); mc.appendChild(b);
                });
            }
            render(); startTimer();
        }

        function startTimer() {
            state.timer = setInterval(() => {
                if(!state.paused && !state.reveal) {
                    state.timeLeft -= 0.1;
                    if(state.blur > 10) state.blur -= 0.2;
                    document.getElementById('timer-bar').style.width = (state.timeLeft / (state.isSteal ? 15 : 30) * 100) + "%";
                    if(document.getElementById('blurry-img')) document.getElementById('blurry-img').style.filter = `blur(${state.blur}px)`;
                    if(state.timeLeft <= 0) handlePass();
                }
            }, 100);
        }

        function checkMC(i) { if(i === state.set[state.qIdx].c) win(); else lose(); }
        function checkTyped() {
            const g = clean(document.getElementById('input-box').value);
            const a = clean(state.set[state.qIdx].ans);
            if(g.includes(a) || a.includes(g) && g.length > 2) win(); else lose();
        }

        function win() { state.scores[state.turn] += state.set[state.qIdx].pts; next(); }
        function lose() { if(!state.isSteal) { state.scores[state.turn] -= state.set[state.qIdx].pts; state.isSteal = true; state.turn = (state.turn === 0 ? 1 : 0); loadQ(); } else { reveal(); } }
        function handlePass() { if(!state.isSteal) { state.isSteal = true; state.turn = (state.turn === 0 ? 1 : 0); loadQ(); } else { reveal(); } }

        function reveal() {
            state.reveal = true; clearInterval(state.timer);
            const q = state.set[state.qIdx];
            document.getElementById('reveal-text').innerText = q.type === 'text' ? q.ans : q.a[q.c];
            document.getElementById('reveal-img-box').innerHTML = q.img ? `<img src="${q.img}" style="max-height:100%; border:5px solid white;">` : '';
            document.getElementById('reveal-screen').classList.remove('hidden');
            setTimeout(next, 4000);
        }

        function next() {
            state.qIdx++; state.isSteal = false; state.turn = state.qIdx % 2;
            if(state.qIdx < state.set.length) loadQ(); else end();
            save();
        }

        function end() {
            document.getElementById('main-ui').classList.add('hidden');
            document.getElementById('end-screen').classList.remove('hidden');
            const w = state.scores[0] > state.scores[1] ? "TEAM A" : "TEAM B";
            document.getElementById('winner-text').innerText = w + " WINS!";
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
        }

        function togglePause() { state.paused = !state.paused; document.getElementById('pause-btn').innerText = state.paused ? "RESUME" : "PAUSE"; }
        function render() {
            document.getElementById('score-a').innerText = state.scores[0];
            document.getElementById('score-b').innerText = state.scores[1];
            document.getElementById('card-a').className = 'team-card' + (state.turn === 0 ? ' active-a' : '');
            document.getElementById('card-b').className = 'team-card' + (state.turn === 1 ? ' active-b' : '');
        }
        function save() { localStorage.setItem('ot_v7', JSON.stringify(state)); }
        function fullReset() { localStorage.clear(); location.reload(); }
    </script>
</body>
</html>
